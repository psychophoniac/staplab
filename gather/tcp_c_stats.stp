function isTarget(tid){
	return pid() == target()
}

//args: sock, send
//args: size, name, sock, family
probe tcp.sendmsg {
	if( isTarget(pid()) ){
		printf("%s socket:%s:%d size:%d\n", 
			ppfunc(), 			//funcname
			inet_get_ip_source(sock),	//socket_ip 				
			inet_get_local_port(sock), 	//socket_port
			size				//toSend datasize 
		)
	}
}

/**
size Number of bytes to be received 
saddr A string representing the source IP address 
sock Network socket 
dport TCP destination port 
family IP address family 
name Name of this probe 
sport TCP source port 
daddr A string representing the destination IP address
**/
probe tcp.recvmsg {
	if( isTarget(pid()) ){
		printf("%s source:%s:%d socket:%s:%d destination:%s:%d size:%d family:%s\n",
			name,
			saddr,
			sport,
			inet_get_ip_source(sock),
			inet_get_local_port(sock),
			daddr,
			dport,
			size,
			sock_fam_num2str(family)
		)
	}
//	printf("%s\n", $$parms)
}
