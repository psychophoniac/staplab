#! /usr/bin/env stap

probe kernel.function("*@net/socket.c").call {
	if(pid() == target())
		printf ("%s -> %s\n", thread_indent(1), ppfunc())
}
probe kernel.function("*@net/socket.c").return {
	if(pid() == target())
		printf ("%s <- %s\n", thread_indent(-1), ppfunc())
}

